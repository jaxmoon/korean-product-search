# AWS 비용 예측 - 한국어 검색 시스템

> 작성일: 2025-10-20
> 리전: ap-northeast-2 (서울)
> 환율: 1 USD = 1,300 KRW (참고용)

## 시스템 구성 요소

현재 시스템:
- **Elasticsearch 8.x** + Nori Plugin (한국어 형태소 분석)
- **NestJS Backend** (Node.js)
- **Frontend** (정적 파일)
- **샘플 데이터**: 1,000개 상품

---

## 시나리오 1: 개발/테스트 환경 (최소 비용)

**가정:**
- 트래픽: 매우 낮음 (개발자 1-2명)
- 가동 시간: 월 160시간 (주중 8시간)
- 데이터: 10,000개 상품

### 구성

| 서비스 | 스펙 | 시간당 비용 | 월 비용 (USD) | 월 비용 (KRW) |
|--------|------|-------------|---------------|---------------|
| **OpenSearch** | t3.small.search (1 노드) | $0.036 | $26.28 | ₩34,164 |
| **EC2** | t3.micro (Backend) | $0.0114 | $8.32 | ₩10,816 |
| **S3** | 1GB (Frontend) | - | $0.025 | ₩33 |
| **CloudFront** | 10GB 전송 | - | $1.26 | ₩1,638 |
| **데이터 전송** | 10GB/월 | - | $0.90 | ₩1,170 |

**총 월 비용: ~$37 (₩48,100)**

**절감 팁:**
- 사용하지 않을 때 인스턴스 중지
- 실제 사용 시간만 과금 (월 160시간 가정)
- **실 비용: ~$15-20 (₩19,500-26,000)**

---

## 시나리오 2: 소규모 프로덕션 (스타트업)

**가정:**
- 월 활성 사용자: 10,000명
- 일일 검색 요청: 50,000건
- 데이터: 100,000개 상품
- 가동 시간: 24/7 (99.9% 가용성)

### 구성

| 서비스 | 스펙 | 시간당 비용 | 월 비용 (USD) | 월 비용 (KRW) |
|--------|------|-------------|---------------|---------------|
| **OpenSearch** | t3.small.search (2 노드) | $0.072 | $52.56 | ₩68,328 |
| **EBS (OpenSearch)** | 20GB x 2 = 40GB | - | $4.00 | ₩5,200 |
| **EC2** | t3.small (Backend) | $0.0228 | $16.64 | ₩21,632 |
| **ALB** | Application Load Balancer | $0.0252 | $18.40 | ₩23,920 |
| **S3** | 5GB (Frontend) | - | $0.13 | ₩169 |
| **CloudFront** | 100GB 전송 | - | $12.60 | ₩16,380 |
| **Route 53** | 호스팅 존 + 쿼리 | - | $1.50 | ₩1,950 |
| **데이터 전송** | 50GB/월 | - | $4.50 | ₩5,850 |

**총 월 비용: ~$110 (₩143,000)**

**추가 고려사항:**
- Auto Scaling 설정 시 +10-20%
- CloudWatch 로그 및 모니터링: +$5-10/월
- **예상 실 비용: $120-140 (₩156,000-182,000)**

---

## 시나리오 3: 중규모 프로덕션 (안정적 운영)

**가정:**
- 월 활성 사용자: 100,000명
- 일일 검색 요청: 500,000건
- 데이터: 1,000,000개 상품
- 가동 시간: 24/7 (99.95% 가용성)
- 고가용성 (Multi-AZ)

### 구성

| 서비스 | 스펙 | 시간당 비용 | 월 비용 (USD) | 월 비용 (KRW) |
|--------|------|-------------|---------------|---------------|
| **OpenSearch** | r6g.large.search (3 노드, Multi-AZ) | $0.378 | $275.94 | ₩358,722 |
| **EBS (OpenSearch)** | 100GB x 3 = 300GB | - | $30.00 | ₩39,000 |
| **ECS Fargate** | 0.5 vCPU, 1GB (2 tasks) | $0.0616 | $44.95 | ₩58,435 |
| **ALB** | Application Load Balancer | $0.0252 | $18.40 | ₩23,920 |
| **S3** | 10GB (Frontend) | - | $0.25 | ₩325 |
| **CloudFront** | 1TB 전송 | - | $85.00 | ₩110,500 |
| **Route 53** | 호스팅 존 + 쿼리 | - | $5.00 | ₩6,500 |
| **데이터 전송** | 500GB/월 | - | $45.00 | ₩58,500 |
| **CloudWatch** | 로그 + 메트릭 | - | $15.00 | ₩19,500 |
| **Backup (S3)** | 스냅샷 + 백업 | - | $10.00 | ₩13,000 |

**총 월 비용: ~$530 (₩689,000)**

**추가 최적화:**
- Reserved Instance (1년 약정): -30% 할인
- Savings Plans 적용: -40% 할인
- **최적화 후 비용: $320-400 (₩416,000-520,000)**

---

## 시나리오 4: 대규모 프로덕션 (엔터프라이즈)

**가정:**
- 월 활성 사용자: 1,000,000명
- 일일 검색 요청: 5,000,000건
- 데이터: 10,000,000개 상품
- 가동 시간: 24/7 (99.99% 가용성)
- Multi-Region 구성

### 구성 (단일 리전 기준)

| 서비스 | 스펙 | 월 비용 (USD) | 월 비용 (KRW) |
|--------|------|---------------|---------------|
| **OpenSearch** | r6g.xlarge.search (6 노드, 3 AZ) | $1,320 | ₩1,716,000 |
| **EBS (OpenSearch)** | 500GB x 6 = 3TB | $300 | ₩390,000 |
| **ECS Fargate** | 2 vCPU, 4GB (6 tasks) | $540 | ₩702,000 |
| **ALB** | 2개 (Public + Internal) | $37 | ₩48,100 |
| **S3** | 50GB (Frontend + Assets) | $1.25 | ₩1,625 |
| **CloudFront** | 10TB 전송 | $600 | ₩780,000 |
| **Route 53** | 고급 라우팅 + Health Check | $30 | ₩39,000 |
| **데이터 전송** | 5TB/월 | $450 | ₩585,000 |
| **CloudWatch** | 상세 로그 + 메트릭 | $100 | ₩130,000 |
| **Backup & DR** | 자동 백업 + 재해 복구 | $150 | ₩195,000 |
| **WAF & Shield** | 보안 | $50 | ₩65,000 |

**총 월 비용 (단일 리전): ~$3,580 (₩4,654,000)**

**Multi-Region (2개 리전):**
- 총 비용: ~$6,500-7,000 (₩8,450,000-9,100,000)

**최적화 후 (Reserved + Savings Plans):**
- **약 $4,000-5,000 (₩5,200,000-6,500,000)**

---

## 비용 절감 전략

### 1. Reserved Instances & Savings Plans (30-40% 절감)
```
OpenSearch 1년 약정: -30% 할인
EC2/ECS 1년 약정: -40% 할인
3년 약정: -60% 할인
```

### 2. 스팟 인스턴스 (70-90% 절감)
```
개발/테스트 환경에서 EC2 스팟 인스턴스 활용
배치 작업용 스팟 인스턴스 사용
```

### 3. Auto Scaling (20-30% 절감)
```
피크 시간대에만 리소스 확장
야간/주말 자동 축소
```

### 4. CloudFront 캐싱 최적화 (40-50% 절감)
```
TTL 최적화로 Origin 요청 감소
정적 파일 장기 캐싱
Gzip/Brotli 압축 활용
```

### 5. OpenSearch 최적화 (20-30% 절감)
```
인덱스 라이프사이클 정책 (ILM) 설정
UltraWarm 노드로 오래된 데이터 이동
샤드 개수 최적화
```

---

## 추천 시나리오별 구성

### 🎯 스타트업 초기 (MVP)
**예상 비용: $50-80/월 (₩65,000-104,000)**
- OpenSearch t3.small.search (1 노드)
- EC2 t3.small (Backend)
- CloudFront + S3
- 필요 시 수평 확장

### 🚀 성장기 스타트업
**예상 비용: $200-300/월 (₩260,000-390,000)**
- OpenSearch t3.medium.search (2 노드)
- ECS Fargate 또는 EC2 Auto Scaling
- ALB + CloudFront
- CloudWatch 모니터링
- Reserved Instance 적용

### 🏢 안정적 서비스 운영
**예상 비용: $400-600/월 (₩520,000-780,000)**
- OpenSearch r6g.large.search (3 노드, Multi-AZ)
- ECS Fargate (고가용성)
- 완전 관리형 인프라
- 백업 & 모니터링
- Savings Plans 적용

---

## 실제 비용 예시 (실사용 데이터 기반)

### Case 1: 중소 쇼핑몰 (상품 50,000개)
```
- 일 방문자: 5,000명
- 일 검색: 20,000건
- 실 비용: $180/월 (₩234,000)
- 구성: t3.medium.search (2 노드) + t3.small EC2
```

### Case 2: 중견기업 검색 서비스 (상품 500,000개)
```
- 일 방문자: 50,000명
- 일 검색: 200,000건
- 실 비용: $650/월 (₩845,000)
- 구성: r6g.large.search (3 노드) + ECS Fargate
```

### Case 3: 대형 플랫폼 (상품 5,000,000개)
```
- 일 방문자: 500,000명
- 일 검색: 2,000,000건
- 실 비용: $2,800/월 (₩3,640,000)
- 구성: r6g.xlarge.search (6 노드) + Multi-AZ
```

---

## 추가 고려사항

### 1. 초기 구축 비용
```
- 마이그레이션: $0 (자체 진행)
- 컨설팅: $0-5,000 (선택사항)
- 개발: 자체 리소스 활용
```

### 2. 숨겨진 비용
```
- NAT Gateway: $32-45/월 (필요 시)
- VPC Endpoint: $7-15/월 (OpenSearch VPC 접근)
- Elastic IP: $3.6/월 (미사용 IP 시)
- CloudWatch Logs: $0.50/GB (로그 많을 경우)
```

### 3. 비용 모니터링
```
- AWS Cost Explorer 활용 (무료)
- AWS Budgets 설정 (알림)
- Trusted Advisor 권장사항 확인
```

---

## 결론 및 권장사항

### 🎯 최적의 시작 구성 (월 $100 이하)
```yaml
OpenSearch:
  - t3.small.search (1 노드)
  - 20GB EBS

Backend:
  - t3.small EC2 또는 Fargate

Frontend:
  - S3 + CloudFront

예상 비용: $70-90/월 (₩91,000-117,000)
```

### 📈 확장 시 고려사항
1. **트래픽 10배 증가 시**: +$200-300/월
2. **데이터 10배 증가 시**: +$150-250/월
3. **Multi-AZ 구성 시**: +50-70% 비용

### 💡 비용 최적화 우선순위
1. **Reserved Instances** (가장 큰 절감 효과)
2. **CloudFront 캐싱** (트래픽 비용 절감)
3. **Auto Scaling** (불필요한 리소스 제거)
4. **스팟 인스턴스** (개발/테스트 환경)
5. **리전 선택** (서울 리전이 다른 리전보다 약간 비쌈)

---

## 참고 링크

- [AWS OpenSearch 요금](https://aws.amazon.com/ko/opensearch-service/pricing/)
- [AWS EC2 요금](https://aws.amazon.com/ko/ec2/pricing/)
- [AWS 요금 계산기](https://calculator.aws/)
- [AWS Pricing Calculator](https://calculator.aws/#/)

---

**마지막 업데이트**: 2025-10-20
**환율**: 1 USD = 1,300 KRW (참고용, 실제 환율은 변동됨)
